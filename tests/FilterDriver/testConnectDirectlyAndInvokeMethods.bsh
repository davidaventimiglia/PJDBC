#!/bin/sh
set -e
bsh -classpath pjdbc.jar <<EOF
    try {
	source("tests/init.bsh");
	import java.sql.*;
	import org.pjdbc.drivers.*;
	getClass("org.pjdbc.drivers.MockDriver");
	Connection c = (Connection)(new FilterDriver().connect("jdbc:filter:jdbc:mock:foo", null));
	MockDriver d = (MockDriver)DriverManager.getDriver("jdbc:mock:foo");
	Statement stmt = c.createStatement();
	String query = "select * from person;";
	stmt.executeQuery(query);
	assertNotNull(d.getLog("jdbc:mock:foo"));
	print(d.getLog("jdbc:mock:foo"));
	assertEquals("executeQuery[select * from person;]", d.getLog("jdbc:mock:foo"));
    } catch (e) {System.exit(1);}
EOF

# Local Variables:
# mode: java
# End:
